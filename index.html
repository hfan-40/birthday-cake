<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rose Gold & Ivory 3D Celebration</title>
    <style>
        @import url('https://gs.jurieo.com/gemini/fonts-googleapis/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital,wght@0,400;1,400&display=swap');

        :root {
            --rose-pink: #F19EB5;
            --metallic-gold: #D4AF37;
            --ivory: #FFFFF0;
            --bg-dark: #050505;
        }

        body, html, #root {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: var(--bg-dark);
            color: var(--ivory); font-family: 'Playfair Display', serif;
        }

        .ui-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; display: flex; flex-direction: column;
            align-items: center; justify-content: space-between;
            padding: 4rem 1rem; z-index: 10; box-sizing: border-box;
        }

        .main-title {
            font-family: 'Cinzel', serif;
            font-size: clamp(2rem, 8vw, 4rem);
            letter-spacing: 0.3em;
            background: linear-gradient(to bottom, #f4e4bc 0%, var(--metallic-gold) 50%, #f4e4bc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: all 1s ease;
            opacity: 0.9;
        }

        .hint-text {
            color: var(--rose-pink);
            font-size: 0.9rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            animation: pulse 2s infinite;
        }

        @keyframes pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }
        canvas { touch-action: none; cursor: pointer; }
    </style>

    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom": "https://esm.sh/react-dom@18.2.0",
        "three": "https://esm.sh/three@0.160.0",
        "@react-three/fiber": "https://esm.sh/@react-three/fiber@8.15.11",
        "@react-three/drei": "https://esm.sh/@react-three/drei@9.88.11"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>

    <div class="ui-container">
        <h1 class="main-title">Happy Birthday</h1>
        <div class="hint-text">Click to light the magic</div>
    </div>

    <script type="module">
        import React, { useRef, useState, useMemo } from 'react';
        import { createRoot } from 'react-dom';
        import * as THREE from 'three';
        import { Canvas, useFrame } from '@react-three/fiber';
        import { Float, OrbitControls, Stars, Environment, MeshReflectorMaterial, Sparkles, PresentationControls } from '@react-three/drei';

        const COLORS = {
            ivory: "#FFFFF0",
            rosePink: "#F19EB5",
            metallicGold: "#D4AF37",
            candleOrange: "#FF9D00"
        };

        // 漂浮的纸屑组件
        const Confetti = ({ count = 50 }) => {
            const range = 15;
            const data = useMemo(() => Array.from({ length: count }, () => ({
                pos: [THREE.MathUtils.randFloatSpread(range), THREE.MathUtils.randFloat(0, range), THREE.MathUtils.randFloatSpread(range)],
                speed: THREE.MathUtils.randFloat(0.01, 0.05),
                rot: Math.random() * Math.PI
            })), [count]);

            const refs = useRef([]);
            useFrame(() => {
                refs.current.forEach((ref, i) => {
                    ref.position.y -= data[i].speed;
                    ref.rotation.x += data[i].speed;
                    if (ref.position.y < -2) ref.position.y = range;
                });
            });

            return data.map((d, i) => (
                React.createElement('mesh', { 
                    key: i, 
                    ref: el => refs.current[i] = el, 
                    position: d.pos,
                    rotation: [d.rot, d.rot, d.rot]
                },
                    React.createElement('planeGeometry', { args: [0.1, 0.1] }),
                    React.createElement('meshBasicMaterial', { 
                        color: i % 2 === 0 ? COLORS.rosePink : COLORS.metallicGold, 
                        side: THREE.DoubleSide,
                        transparent: true,
                        opacity: 0.6
                    })
                )
            ));
        };

        const CakeModel = ({ active }) => {
            const cakeGroup = useRef();

            useFrame((state) => {
                const t = state.clock.getElapsedTime();
                cakeGroup.current.rotation.y = Math.sin(t * 0.15) * 0.1;
            });

            return React.createElement('group', { ref: cakeGroup, position: [0, -0.8, 0] },
                // 蛋糕层
                [[2.2, 1.2, 0, COLORS.ivory], [1.6, 1.1, 1.15, COLORS.rosePink], [1, 1, 2.2, COLORS.ivory]].map(([r, h, y, col], i) => (
                    React.createElement('mesh', { key: i, position: [0, y, 0], castShadow: true },
                        React.createElement('cylinderGeometry', { args: [r, r, h, 64] }),
                        React.createElement('meshStandardMaterial', { color: col, roughness: 0.2, metalness: 0.1 })
                    )
                )),

                // 金属装饰环
                [[2.25, 0], [1.65, 1.15], [1.05, 2.2]].map(([r, y], i) => (
                    React.createElement('mesh', { key: i, position: [0, y, 0], rotation: [Math.PI/2, 0, 0] },
                        React.createElement('torusGeometry', { args: [r, 0.04, 16, 100] }),
                        React.createElement('meshStandardMaterial', { color: COLORS.metallicGold, metalness: 1, roughness: 0.1 })
                    )
                )),

                // 蜡烛交互部分
                React.createElement('group', { position: [0, 2.8, 0] },
                    React.createElement('mesh', null,
                        React.createElement('cylinderGeometry', { args: [0.04, 0.04, 0.6] }),
                        React.createElement('meshStandardMaterial', { color: COLORS.metallicGold, metalness: 0.9 })
                    ),
                    active && React.createElement(React.Fragment, null,
                        React.createElement(Sparkles, { count: 30, scale: 2.5, size: 3, speed: 0.5, color: COLORS.metallicGold }),
                        React.createElement('pointLight', { intensity: 4, distance: 6, color: COLORS.candleOrange }),
                        React.createElement('mesh', { position: [0, 0.45, 0] },
                            React.createElement('sphereGeometry', { args: [0.08, 16, 16] }),
                            React.createElement('meshBasicMaterial', { color: "#FFF" })
                        )
                    )
                )
            );
        };

        const Scene = () => {
            const [active, setActive] = useState(false);

            return React.createElement(Canvas, { 
                shadows: true, camera: { position: [0, 2, 10], fov: 35 },
                onClick: () => setActive(true)
            },
                React.createElement('color', { attach: "background", args: ["#050505"] }),
                React.createElement('ambientLight', { intensity: active ? 0.6 : 0.2 }),
                React.createElement('spotLight', { position: [10, 10, 10], angle: 0.15, penumbra: 1, intensity: active ? 2 : 0.5, castShadow: true }),
                
                React.createElement(PresentationControls, { global: true, config: { mass: 2, tension: 500 }, snap: true, rotation: [0, 0.3, 0], polar: [-Math.PI / 4, Math.PI / 4] },
                    React.createElement(CakeModel, { active: active })
                ),

                active && React.createElement(Confetti, { count: 80 }),
                React.createElement(Stars, { radius: 50, count: 2000, factor: 4, fade: true }),
                React.createElement(Environment, { preset: "city" }),

                // 镜面反射地面
                React.createElement('mesh', { rotation: [-Math.PI / 2, 0, 0], position: [0, -2, 0] },
                    React.createElement('planeGeometry', { args: [50, 50] }),
                    React.createElement(MeshReflectorMaterial, {
                        blur: [400, 100], resolution: 1024, mixBlur: 1, mixStrength: 15,
                        depthScale: 1, minDepthThreshold: 0.85, color: "#151515", metalness: 0.5, roughness: 1
                    })
                )
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(Scene));
    </script>
</body>
</html>
